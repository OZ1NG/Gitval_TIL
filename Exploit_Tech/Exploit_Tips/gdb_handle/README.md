# GDB - handle 명령어

gdb에서는 handle 명령어를 이용해서 동적 분석 도중에 생기는 각종 SIGNAL들을 확인, 무시, 종료 할 수 있습니다.

기본적으로 제가 자주 사용하는 gdb 플러그인인 pwndbg는 SIGALRM 같은 시그널이 발생했을 경우 무시를 해서 분석 도중 강제로 alarm_handle이 호출되서 종료가 되거나 하는 것들을 방지 해줍니다.

하지만, 가끔은 alarm_handle 함수에서 호출되는 exit와 같은 함수를 이용해야 하는 경우들이 있는데 이럴 경우 시그널에 대한 흐름을 설정해주면 좀더 효율적인 분석이 가능해집니다.



## info handle

```
pwndbg> info handle
Signal        Stop      Print   Pass to program Description

SIGHUP        Yes       Yes     Yes             Hangup
SIGINT        Yes       Yes     No              Interrupt
SIGQUIT       Yes       Yes     Yes             Quit
SIGILL        Yes       Yes     Yes             Illegal instruction
SIGTRAP       Yes       Yes     No              Trace/breakpoint trap
SIGABRT       Yes       Yes     Yes             Aborted
SIGEMT        Yes       Yes     Yes             Emulation trap
SIGFPE        Yes       Yes     Yes             Arithmetic exception
SIGKILL       Yes       Yes     Yes             Killed
SIGBUS        Yes       Yes     No              Bus error
SIGSEGV       Yes       Yes     No              Segmentation fault
...
```

- 위와 같이 ```info handle``` 명령어를 사용하면 모든 시그널에 대한 정보를 볼 수 있습니다.

- ```info handle SIGSEGV``` 와 같이 사용하여 특정 SIGNAL에 대한 정보만 확인 할 수도 있습니다.



## handle [SIGNAL]

```
pwndbg> handle 14
Signal        Stop      Print   Pass to program Description
SIGALRM       No        Yes     Yes             Alarm clock
pwndbg> handle SIGALRM
Signal        Stop      Print   Pass to program Description
SIGALRM       No        Yes     Yes             Alarm clock
```

- 위와 같이 ```handle [SIG_Name or SIG_num]``` 명령어를 이용하면, ```info handle [SIGNAL]```을 하는 것과 같은 결과를 얻을 수 있습니다.



## handle 시그널 흐름 제어

```
stop - nostop
print - noprint
pass - nopass
ignore - noignore
```

- handle 명령어는 위의 4가지종류의 명령어를 사용해서 시그널에 대한 흐름을 변경할 수 있습니다.

- 예시

  ```bash
  # SIGALRM을 무시하고 싶은 경우
  handle SIGALRM ignore
  
  # SIGALRM을 무시하고 싶지 않은 경우
  handle SIGALRM noignore
  
  # SIGALRM을 출력하고 싶지 않은 경우 + 무시하고 싶지 않은 경우
  handle SIGALRM noprint noignore
  ```

  - 이때, 무시한다는 뜻은 SIGALRM에 대한 handler를 호출하지 않고 그냥 넘어간다는 뜻입니다.



## Reference

https://realsung.github.io/notes/Pwnable/handle